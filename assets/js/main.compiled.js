(()=>{function x(){if(typeof window.Fuse=="undefined"){console.warn("\u26A0\uFE0F Fuse.js non disponible");return}B().then(o=>R(o)).catch(o=>{console.error("\u274C Erreur chargement index:",o)})}async function B(){try{let o=await fetch("/index.json");if(!o.ok)throw new Error("Index non trouv\xE9");return await o.json()}catch(o){return console.error("Erreur fetch:",o),[]}}function R(o){let e={keys:["title","tags","categories"],threshold:.3,includeMatches:!0,minMatchCharLength:2},r=new window.Fuse(o,e);[{input:document.getElementById("search-input"),clear:document.getElementById("search-clear-input"),results:document.getElementById("search-results-input"),type:"desktop"},{input:document.getElementById("search-mobile-input"),clear:document.getElementById("search-clear-mobile-input"),results:document.getElementById("search-results-mobile-input"),type:"mobile"}].forEach(({input:t,clear:s,results:l,type:c})=>{if(!t||!l){console.warn(`\u26A0\uFE0F \xC9l\xE9ments manquants pour ${c}`);return}let n=null,a=-1;function u(m){if(m.key!=="Enter")return;if(m.preventDefault(),m.stopPropagation(),m.stopImmediatePropagation(),c==="mobile")return m.target.blur(),!1;if(!t.value.trim())return!1;let d=l.querySelectorAll(".search-result-item");if(a>=0&&d[a]){let f=d[a].querySelector("a");if(f)return window.location.href=f.href,!1}if(d.length>0){let f=d[0].querySelector("a");if(f)return window.location.href=f.href,!1}return!1}t.addEventListener("keydown",u,!0),t.addEventListener("keypress",u,!0);function h(m){l.innerHTML="";let d=m.length>0;if(l.classList.toggle("hidden",!d),t.setAttribute("aria-expanded",d),!d){a=-1;return}m.forEach((f,p)=>{let g=document.createElement("li");g.className="search-result-item",g.setAttribute("role","option"),g.setAttribute("aria-selected",p===a);let w=y(f.item.title,f.matches);g.innerHTML=`
          <a href="${f.item.url}" class="block">
            <div class="search-result-title">${w}</div>
            ${f.item.categories?`
              <div class="search-result-category">
                ${f.item.categories.join(", ")}
              </div>
            `:""}
            ${f.item.excerpt?`
              <div class="search-result-excerpt">${f.item.excerpt}</div>
            `:""}
          </a>
        `,l.appendChild(g)})}function y(m,d){if(!d||!d.length)return m;let f=m;return d.forEach(p=>{p.key==="title"&&p.indices.forEach(([g,w])=>{let k=m.substring(g,w+1);f=f.replace(k,`<mark style="background-color: #EA580C; color: white; padding: 1px 3px; border-radius: 3px;">${k}</mark>`)})}),f}function A(m){if(clearTimeout(n),!m.trim()){h([]),s&&s.classList.add("hidden");return}s&&s.classList.remove("hidden"),n=setTimeout(()=>{let d=r.search(m);h(d)},300)}t.addEventListener("input",m=>{A(m.target.value)}),s&&s.addEventListener("click",()=>{t.value="",h([]),s.classList.add("hidden"),t.focus()}),t.addEventListener("keydown",m=>{if(m.key==="Enter")return;let d=l.querySelectorAll(".search-result-item");if(d.length)switch(m.key){case"ArrowDown":m.preventDefault(),a=(a+1)%d.length,L(d);break;case"ArrowUp":m.preventDefault(),a=a<=0?d.length-1:a-1,L(d);break;case"Escape":m.preventDefault(),t.value="",h([]),s&&s.classList.add("hidden"),t.blur();break}});function L(m){m.forEach((d,f)=>{let p=f===a;d.setAttribute("aria-selected",p),p?(d.style.backgroundColor="var(--color-bg-alt)",d.style.borderLeft="3px solid var(--primary)",d.style.paddingLeft="calc(var(--space-5) - 3px)"):(d.style.backgroundColor="",d.style.borderLeft="",d.style.paddingLeft="")}),m[a]&&m[a].scrollIntoView({block:"nearest",behavior:"smooth"})}t.addEventListener("focus",()=>{l.children.length>0&&(l.classList.remove("hidden"),t.setAttribute("aria-expanded","true"))}),t.addEventListener("blur",()=>{setTimeout(()=>{l.classList.add("hidden"),t.setAttribute("aria-expanded","false"),a=-1},200)})}),console.log("\u2705 Recherche initialis\xE9e avec",o.length,"recettes")}function I(){let o=document.getElementById("contact-form"),e=document.getElementById("form-status");!o||!e||(o.noValidate=!0,o.addEventListener("submit",async r=>{if(r.preventDefault(),!o.checkValidity()){e.textContent="Merci de remplir tous les champs requis !",o.reportValidity();return}let i=o.querySelector('[type="submit"]');i==null||i.setAttribute("disabled",!0),e.textContent="Envoi en cours\u2026";try{let t=await fetch(o.action,{method:o.method,body:new FormData(o),headers:{Accept:"application/json"}});if(t.ok)e.textContent="Merci ! Ton message a bien \xE9t\xE9 envoy\xE9.",o.reset();else{let{error:s}=await t.json().catch(()=>({}));e.textContent=s!=null?s:"Oups ! Une erreur est survenue."}}catch(t){e.textContent="Impossible d\u2019envoyer le message. V\xE9rifie ta connexion."}finally{i==null||i.removeAttribute("disabled")}}))}function v(){let o=document.body.dataset.randomRecipes;if(o)try{let e=JSON.parse(o);if(!e||e.length===0){console.warn("Aucune recette disponible pour la redirection al\xE9atoire");return}let r=e[Math.floor(Math.random()*e.length)];window.location.replace(r)}catch(e){console.error("Erreur lors de la redirection al\xE9atoire:",e),window.location.href="/random/"}}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",v):v();function S(){if(!document.getElementById("stickyNav"))return;let e=["ingredients","steps","faq"];function r(){let c="ingredients";for(let n of e){let a=document.getElementById(n);a&&a.getBoundingClientRect().top<=120&&(c=n)}document.querySelectorAll("#stickyNav .navLink").forEach(n=>{n.classList.toggle("text-[var(--clr-primary)]",n.dataset.target===c)})}document.addEventListener("scroll",()=>requestAnimationFrame(r)),r();let i=document.getElementById("navSaveBtn"),t=location.pathname;function s(){let n=JSON.parse(localStorage.getItem("favs")||"[]").includes(t);i.classList.toggle("opacity-60",n)}function l(){let c=JSON.parse(localStorage.getItem("favs")||"[]"),n=c.indexOf(t);n>-1?c.splice(n,1):c.push(t),localStorage.setItem("favs",JSON.stringify(c)),s()}i==null||i.addEventListener("click",l),document.addEventListener("DOMContentLoaded",s)}function C(){let o=document.getElementById("shareButton"),e=document.getElementById("shareMenu"),r=document.getElementById("printButton"),i=document.getElementById("pinterestPinButton");if(!o||!e)return;let t=!1;function s(){t=!t,e.classList.toggle("is-active",t),o.setAttribute("aria-expanded",t)}function l(){t=!1,e.classList.remove("is-active"),o.setAttribute("aria-expanded","false")}o.addEventListener("click",n=>{n.stopPropagation(),s()}),document.addEventListener("click",l),e.addEventListener("click",n=>n.stopPropagation()),r==null||r.addEventListener("click",l),i==null||i.addEventListener("click",l);let c={copyLink:()=>{navigator.clipboard.writeText(window.location.href).then(()=>M("Lien copi\xE9 !")).catch(()=>T())},email:()=>{let n=encodeURIComponent(document.title),a=encodeURIComponent(`D\xE9couvrez cette recette : ${window.location.href}`);window.open(`mailto:?subject=${n}&body=${a}`,"_blank")},pinterest:()=>{var y;let n=encodeURIComponent(window.location.href),a=encodeURIComponent(document.title),u=((y=document.querySelector('meta[property="og:image"]'))==null?void 0:y.content)||"",h=encodeURIComponent(u);window.open(`https://pinterest.com/pin/create/button/?url=${n}&description=${a}&media=${h}`,"_blank")},facebook:()=>{let n=encodeURIComponent(window.location.href);window.open(`https://www.facebook.com/sharer/sharer.php?u=${n}`,"_blank")},twitter:()=>{let n=encodeURIComponent(window.location.href),a=encodeURIComponent(document.title);window.open(`https://twitter.com/intent/tweet?url=${n}&text=${a}`,"_blank")},whatsapp:()=>{let n=encodeURIComponent(`${document.title} - ${window.location.href}`);window.open(`https://wa.me/?text=${n}`,"_blank")},reddit:()=>{let n=encodeURIComponent(window.location.href),a=encodeURIComponent(document.title);window.open(`https://reddit.com/submit?url=${n}&title=${a}`,"_blank")},print:()=>window.print()};Object.entries(c).forEach(([n,a])=>{let u=document.getElementById(`${n}Button`);u&&u.addEventListener("click",()=>{a(),l()})}),i==null||i.addEventListener("click",c.pinterest)}function M(o){let e=document.createElement("div");e.className="fixed top-4 right-4 bg-green-600 text-white px-6 py-3 rounded-lg shadow-lg z-toast animate-slide-in-right",e.textContent=o,document.body.appendChild(e),setTimeout(()=>{e.classList.add("animate-slide-out-right"),setTimeout(()=>e.remove(),300)},3e3)}function T(){let o=document.createElement("input");o.value=window.location.href,document.body.appendChild(o),o.select(),document.execCommand("copy"),document.body.removeChild(o),M("Lien copi\xE9 !")}var b=class{constructor(){this.modules=new Map,this.initialized=!1}async init(){if(!this.initialized)try{await this.domReady(),this.initCoreModules(),this.initPageModules(),this.initGlobalFeatures(),this.initialized=!0,console.log("\u2705 Application initialis\xE9e")}catch(e){console.error("\u274C Erreur d'initialisation:",e),this.handleError(e)}}domReady(){return new Promise(e=>{document.readyState==="loading"?document.addEventListener("DOMContentLoaded",e):e()})}initCoreModules(){this.initMobileMenu(),this.initSearchModule(),this.initSmoothScroll()}initPageModules(){let{pathname:e}=window.location;document.body.dataset.randomRecipes&&this.modules.set("randomHome",v()),e.includes("/recipes/")&&document.getElementById("stickyNav")&&this.modules.set("stickyNav",S()),document.getElementById("contact-form")&&this.modules.set("contactForm",I()),document.querySelector(".cta-buttons-container")&&this.modules.set("ctaButtons",C())}initGlobalFeatures(){this.initLazyLoading(),this.initServiceWorker(),this.initScrollToTop(),this.initFilterReset()}initMobileMenu(){let e=document.getElementById("mobile-menu-toggle"),r=document.getElementById("mobile-menu"),i=document.getElementById("mobile-search-toggle"),t=document.getElementById("mobile-search"),s=document.getElementById("menu-icon"),l=document.getElementById("close-icon");if(!e||!r)return;let c=!1,n=!1,a=()=>{c&&(c=!1,this.toggleMenu(r,!1),s&&l&&(s.classList.remove("hidden"),l.classList.add("hidden")),e.setAttribute("aria-expanded",!1)),n&&t&&(n=!1,this.toggleMenu(t,!1))};window.addEventListener("pageshow",u=>{(u.persisted||performance.navigation&&performance.navigation.type===performance.navigation.TYPE_BACK_FORWARD)&&a()}),window.addEventListener("popstate",()=>{a()}),r.addEventListener("click",u=>{u.target.tagName==="A"&&a()}),t&&t.addEventListener("click",u=>{(u.target.tagName==="A"||u.target.closest("a"))&&a()}),e.addEventListener("click",u=>{u.preventDefault(),u.stopPropagation(),c=!c,this.toggleMenu(r,c),s&&l&&(s.classList.toggle("hidden",c),l.classList.toggle("hidden",!c)),e.setAttribute("aria-expanded",c),n&&t&&(n=!1,this.toggleMenu(t,!1))}),i&&t&&i.addEventListener("click",u=>{if(u.preventDefault(),u.stopPropagation(),n=!n,this.toggleMenu(t,n),c&&(c=!1,this.toggleMenu(r,!1),s&&l&&(s.classList.remove("hidden"),l.classList.add("hidden")),e.setAttribute("aria-expanded",!1)),n){let h=t.querySelector("input");h&&setTimeout(()=>h.focus(),100)}}),document.addEventListener("click",u=>{!r.contains(u.target)&&!e.contains(u.target)&&c&&(c=!1,this.toggleMenu(r,!1),s&&l&&(s.classList.remove("hidden"),l.classList.add("hidden")),e.setAttribute("aria-expanded",!1)),t&&!t.contains(u.target)&&!i.contains(u.target)&&n&&(n=!1,this.toggleMenu(t,!1))}),document.addEventListener("keydown",u=>{u.key==="Escape"&&(c&&(c=!1,this.toggleMenu(r,!1),s&&l&&(s.classList.remove("hidden"),l.classList.add("hidden")),e.setAttribute("aria-expanded",!1),e.focus()),n&&t&&(n=!1,this.toggleMenu(t,!1),i&&i.focus()))})}toggleMenu(e,r){r?(e.classList.remove("hidden"),requestAnimationFrame(()=>{e.classList.add("animate-slide-in-down")})):(e.classList.add("hidden"),e.classList.remove("animate-slide-in-down"))}initSearchModule(){if(typeof window.Fuse=="undefined"){setTimeout(()=>this.initSearchModule(),500);return}x()}initSmoothScroll(){document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",r=>{let i=e.getAttribute("href");if(i==="#")return;let t=document.querySelector(i);t&&(r.preventDefault(),t.scrollIntoView({behavior:"smooth",block:"start"}),history.pushState(null,null,i))})})}initLazyLoading(){if("IntersectionObserver"in window){let e=new IntersectionObserver((r,i)=>{r.forEach(t=>{if(t.isIntersecting){let s=t.target;s.src=s.dataset.src||s.src,s.classList.add("fade-in"),i.unobserve(s)}})});document.querySelectorAll('img[loading="lazy"]').forEach(r=>{e.observe(r)})}}initServiceWorker(){"serviceWorker"in navigator&&location.protocol==="https:"&&navigator.serviceWorker.register("/sw.js").then(e=>{console.log("\u2705 Service Worker enregistr\xE9:",e.scope)}).catch(e=>{console.error("\u274C Erreur Service Worker:",e)})}initScrollToTop(){let e=document.getElementById("scrollToTop");if(!e)return;e.addEventListener("click",()=>{window.scrollTo({top:0,behavior:"smooth"})});let r=()=>{window.pageYOffset>300?(e.style.opacity="1",e.style.visibility="visible"):(e.style.opacity="0",e.style.visibility="hidden")};e.style.opacity="0",e.style.visibility="hidden",e.style.transition="opacity 0.3s ease, visibility 0.3s ease",window.addEventListener("scroll",r)}initFilterReset(){let e=document.getElementById("filter-reset");e&&e.addEventListener("click",()=>{let r=document.getElementById("filter-category"),i=document.getElementById("filter-tag"),t=document.getElementById("filter-time"),s=document.querySelector(".search-input");r&&(r.selectedIndex=0),i&&(i.selectedIndex=0),t&&(t.value=""),s&&(s.value=""),typeof window.filterRecipes=="function"&&window.filterRecipes(),document.dispatchEvent(new CustomEvent("filtersReset"))})}handleError(e){console.error("Erreur application:",e),e.critical&&this.showNotification("Une erreur est survenue. Veuillez rafra\xEEchir la page.","error")}showNotification(e,r="info"){let i=document.createElement("div");i.className=`notification notification-${r}`,i.textContent=e,Object.assign(i.style,{position:"fixed",top:"20px",right:"20px",padding:"12px 20px",borderRadius:"6px",backgroundColor:r==="error"?"#ef4444":"#10b981",color:"white",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)",zIndex:"9999",transform:"translateX(400px)",transition:"transform 0.3s ease"}),document.body.appendChild(i),requestAnimationFrame(()=>{i.style.transform="translateX(0)"}),setTimeout(()=>{i.style.transform="translateX(400px)",setTimeout(()=>i.remove(),300)},3e3)}},E=new b;document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>E.init()):E.init();var P=E;})();
