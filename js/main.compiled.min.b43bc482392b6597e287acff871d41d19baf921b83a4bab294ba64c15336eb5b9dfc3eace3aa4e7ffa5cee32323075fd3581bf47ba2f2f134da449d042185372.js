(()=>{function s(){if(typeof window.Fuse=="undefined"){console.warn("⚠️ Fuse.js non disponible");return}o().then(e=>i(e)).catch(e=>{console.error("❌ Erreur chargement index:",e)})}async function o(){try{let e=await fetch("/index.json");if(!e.ok)throw new Error("Index non trouv\xE9");return await e.json()}catch(e){return console.error("Erreur fetch:",e),[]}}function i(e){let t={keys:["title","tags","categories"],threshold:.3,includeMatches:!0,minMatchCharLength:2},n=new window.Fuse(e,t);[{input:document.getElementById("search-input"),clear:document.getElementById("search-clear-input"),results:document.getElementById("search-results-input"),type:"desktop"},{input:document.getElementById("search-mobile-input"),clear:document.getElementById("search-clear-mobile-input"),results:document.getElementById("search-results-mobile-input"),type:"mobile"}].forEach(({input:e,clear:t,results:s,type:o})=>{if(!e||!s){console.warn(`⚠️ \xC9l\xE9ments manquants pour ${o}`);return}let r=null,i=-1;function c(t){if(t.key!=="Enter")return;if(t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),o==="mobile")return t.target.blur(),!1;if(!e.value.trim())return!1;let n=s.querySelectorAll(".search-result-item");if(i>=0&&n[i]){let e=n[i].querySelector("a");if(e)return window.location.href=e.href,!1}if(n.length>0){let e=n[0].querySelector("a");if(e)return window.location.href=e.href,!1}return!1}e.addEventListener("keydown",c,!0),e.addEventListener("keypress",c,!0);function a(t){s.innerHTML="";let n=t.length>0;if(s.classList.toggle("hidden",!n),e.setAttribute("aria-expanded",n),!n){i=-1;return}t.forEach((e,t)=>{let n=document.createElement("li");n.className="search-result-item",n.setAttribute("role","option"),n.setAttribute("aria-selected",t===i);let o=d(e.item.title,e.matches);n.innerHTML=`
          <a href="${e.item.url}" class="block">
            <div class="search-result-title">${o}</div>
            ${e.item.categories?`
              <div class="search-result-category">
                ${e.item.categories.join(", ")}
              </div>
            `:""}
            ${e.item.excerpt?`
              <div class="search-result-excerpt">${e.item.excerpt}</div>
            `:""}
          </a>
        `,s.appendChild(n)})}function d(e,t){if(!t||!t.length)return e;let n=e;return t.forEach(t=>{t.key==="title"&&t.indices.forEach(([t,s])=>{let o=e.substring(t,s+1);n=n.replace(o,`<mark style="background-color: #EA580C; color: white; padding: 1px 3px; border-radius: 3px;">${o}</mark>`)})}),n}function u(e){if(clearTimeout(r),!e.trim()){a([]),t&&t.classList.add("hidden");return}t&&t.classList.remove("hidden"),r=setTimeout(()=>{let t=n.search(e);a(t)},300)}e.addEventListener("input",e=>{u(e.target.value)}),t&&t.addEventListener("click",()=>{e.value="",a([]),t.classList.add("hidden"),e.focus()}),e.addEventListener("keydown",n=>{if(n.key==="Enter")return;let o=s.querySelectorAll(".search-result-item");if(o.length)switch(n.key){case"ArrowDown":n.preventDefault(),i=(i+1)%o.length,l(o);break;case"ArrowUp":n.preventDefault(),i=i<=0?o.length-1:i-1,l(o);break;case"Escape":n.preventDefault(),e.value="",a([]),t&&t.classList.add("hidden"),e.blur();break}});function l(e){e.forEach((e,t)=>{let n=t===i;e.setAttribute("aria-selected",n),n?(e.style.backgroundColor="var(--color-bg-alt)",e.style.borderLeft="3px solid var(--primary)",e.style.paddingLeft="calc(var(--space-5) - 3px)"):(e.style.backgroundColor="",e.style.borderLeft="",e.style.paddingLeft="")}),e[i]&&e[i].scrollIntoView({block:"nearest",behavior:"smooth"})}e.addEventListener("focus",()=>{s.children.length>0&&(s.classList.remove("hidden"),e.setAttribute("aria-expanded","true"))}),e.addEventListener("blur",()=>{setTimeout(()=>{s.classList.add("hidden"),e.setAttribute("aria-expanded","false"),i=-1},200)})}),console.log("✅ Recherche initialis\xE9e avec",e.length,"recettes")}function a(){let e=document.getElementById("contact-form"),t=document.getElementById("form-status");!e||!t||(e.noValidate=!0,e.addEventListener("submit",async n=>{if(n.preventDefault(),!e.checkValidity()){t.textContent="Merci de remplir tous les champs requis !",e.reportValidity();return}let s=e.querySelector('[type="submit"]');s==null||s.setAttribute("disabled",!0),t.textContent="Envoi en cours…";try{let n=await fetch(e.action,{method:e.method,body:new FormData(e),headers:{Accept:"application/json"}});if(n.ok)t.textContent="Merci ! Ton message a bien \xE9t\xE9 envoy\xE9.",e.reset();else{let{error:e}=await n.json().catch(()=>({}));t.textContent=e??"Oups ! Une erreur est survenue."}}catch{t.textContent="Impossible d’envoyer le message. V\xE9rifie ta connexion."}finally{s==null||s.removeAttribute("disabled")}}))}function e(){let e=document.body.dataset.randomRecipes;if(e)try{let t=JSON.parse(e);if(!t||t.length===0){console.warn("Aucune recette disponible pour la redirection al\xE9atoire");return}let n=t[Math.floor(Math.random()*t.length)];window.location.replace(n)}catch(e){console.error("Erreur lors de la redirection al\xE9atoire:",e),window.location.href="/random/"}}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",e):e();function r(){if(!document.getElementById("stickyNav"))return;let o=["ingredients","steps","faq"];function n(){let e="ingredients";for(let t of o){let n=document.getElementById(t);n&&n.getBoundingClientRect().top<=120&&(e=t)}document.querySelectorAll("#stickyNav .navLink").forEach(t=>{t.classList.toggle("text-[var(--clr-primary)]",t.dataset.target===e)})}document.addEventListener("scroll",()=>requestAnimationFrame(n)),n();let e=document.getElementById("navSaveBtn"),t=location.pathname;function s(){let n=JSON.parse(localStorage.getItem("favs")||"[]").includes(t);e.classList.toggle("opacity-60",n)}function i(){let e=JSON.parse(localStorage.getItem("favs")||"[]"),n=e.indexOf(t);n>-1?e.splice(n,1):e.push(t),localStorage.setItem("favs",JSON.stringify(e)),s()}e==null||e.addEventListener("click",i),document.addEventListener("DOMContentLoaded",s)}function c(){let t=document.getElementById("shareButton"),s=document.getElementById("shareMenu"),a=document.getElementById("printButton"),o=document.getElementById("pinterestPinButton");if(!t||!s)return;let e=!1;function c(){e=!e,s.classList.toggle("is-active",e),t.setAttribute("aria-expanded",e)}function i(){e=!1,s.classList.remove("is-active"),t.setAttribute("aria-expanded","false")}t.addEventListener("click",e=>{e.stopPropagation(),c()}),document.addEventListener("click",i),s.addEventListener("click",e=>e.stopPropagation()),a==null||a.addEventListener("click",i),o==null||o.addEventListener("click",i);let r={copyLink:()=>{navigator.clipboard.writeText(window.location.href).then(()=>n("Lien copi\xE9 !")).catch(()=>l())},email:()=>{let e=encodeURIComponent(document.title),t=encodeURIComponent(`D\xE9couvrez cette recette : ${window.location.href}`);window.open(`mailto:?subject=${e}&body=${t}`,"_blank")},pinterest:()=>{var e;let t=encodeURIComponent(window.location.href),n=encodeURIComponent(document.title),s=((e=document.querySelector('meta[property="og:image"]'))==null?0[0]:e.content)||"",o=encodeURIComponent(s);window.open(`https://pinterest.com/pin/create/button/?url=${t}&description=${n}&media=${o}`,"_blank")},facebook:()=>{let e=encodeURIComponent(window.location.href);window.open(`https://www.facebook.com/sharer/sharer.php?u=${e}`,"_blank")},twitter:()=>{let e=encodeURIComponent(window.location.href),t=encodeURIComponent(document.title);window.open(`https://twitter.com/intent/tweet?url=${e}&text=${t}`,"_blank")},whatsapp:()=>{let e=encodeURIComponent(`${document.title} - ${window.location.href}`);window.open(`https://wa.me/?text=${e}`,"_blank")},reddit:()=>{let e=encodeURIComponent(window.location.href),t=encodeURIComponent(document.title);window.open(`https://reddit.com/submit?url=${e}&title=${t}`,"_blank")},print:()=>window.print()};Object.entries(r).forEach(([e,t])=>{let n=document.getElementById(`${e}Button`);n&&n.addEventListener("click",()=>{t(),i()})}),o==null||o.addEventListener("click",r.pinterest)}function n(e){let t=document.createElement("div");t.className="fixed top-4 right-4 bg-green-600 text-white px-6 py-3 rounded-lg shadow-lg z-toast animate-slide-in-right",t.textContent=e,document.body.appendChild(t),setTimeout(()=>{t.classList.add("animate-slide-out-right"),setTimeout(()=>t.remove(),300)},3e3)}function l(){let e=document.createElement("input");e.value=window.location.href,document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e),n("Lien copi\xE9 !")}var u,d=class{constructor(){this.modules=new Map,this.initialized=!1}async init(){if(!this.initialized)try{await this.domReady(),this.initCoreModules(),this.initPageModules(),this.initGlobalFeatures(),this.initialized=!0,console.log("✅ Application initialis\xE9e")}catch(e){console.error("❌ Erreur d'initialisation:",e),this.handleError(e)}}domReady(){return new Promise(e=>{document.readyState==="loading"?document.addEventListener("DOMContentLoaded",e):e()})}initCoreModules(){this.initMobileMenu(),this.initSearchModule(),this.initSmoothScroll()}initPageModules(){let{pathname:t}=window.location;document.body.dataset.randomRecipes&&this.modules.set("randomHome",e()),t.includes("/recipes/")&&document.getElementById("stickyNav")&&this.modules.set("stickyNav",r()),document.getElementById("contact-form")&&this.modules.set("contactForm",a()),document.querySelector(".cta-buttons-container")&&this.modules.set("ctaButtons",c())}initGlobalFeatures(){this.initLazyLoading(),this.initServiceWorker(),this.initScrollToTop(),this.initFilterReset()}initMobileMenu(){let i=document.getElementById("mobile-menu-toggle"),a=document.getElementById("mobile-menu"),r=document.getElementById("mobile-search-toggle"),e=document.getElementById("mobile-search"),s=document.getElementById("menu-icon"),o=document.getElementById("close-icon");if(!i||!a)return;let t=!1,n=!1,c=()=>{t&&(t=!1,this.toggleMenu(a,!1),s&&o&&(s.classList.remove("hidden"),o.classList.add("hidden")),i.setAttribute("aria-expanded",!1)),n&&e&&(n=!1,this.toggleMenu(e,!1))};window.addEventListener("pageshow",e=>{(e.persisted||performance.navigation&&performance.navigation.type===performance.navigation.TYPE_BACK_FORWARD)&&c()}),window.addEventListener("popstate",()=>{c()}),a.addEventListener("click",e=>{e.target.tagName==="A"&&c()}),e&&e.addEventListener("click",e=>{(e.target.tagName==="A"||e.target.closest("a"))&&c()}),i.addEventListener("click",r=>{r.preventDefault(),r.stopPropagation(),t=!t,this.toggleMenu(a,t),s&&o&&(s.classList.toggle("hidden",t),o.classList.toggle("hidden",!t)),i.setAttribute("aria-expanded",t),n&&e&&(n=!1,this.toggleMenu(e,!1))}),r&&e&&r.addEventListener("click",r=>{if(r.preventDefault(),r.stopPropagation(),n=!n,this.toggleMenu(e,n),t&&(t=!1,this.toggleMenu(a,!1),s&&o&&(s.classList.remove("hidden"),o.classList.add("hidden")),i.setAttribute("aria-expanded",!1)),n){let t=e.querySelector("input");t&&setTimeout(()=>t.focus(),100)}}),document.addEventListener("click",c=>{!a.contains(c.target)&&!i.contains(c.target)&&t&&(t=!1,this.toggleMenu(a,!1),s&&o&&(s.classList.remove("hidden"),o.classList.add("hidden")),i.setAttribute("aria-expanded",!1)),e&&!e.contains(c.target)&&!r.contains(c.target)&&n&&(n=!1,this.toggleMenu(e,!1))}),document.addEventListener("keydown",c=>{c.key==="Escape"&&(t&&(t=!1,this.toggleMenu(a,!1),s&&o&&(s.classList.remove("hidden"),o.classList.add("hidden")),i.setAttribute("aria-expanded",!1),i.focus()),n&&e&&(n=!1,this.toggleMenu(e,!1),r&&r.focus()))})}toggleMenu(e,t){t?(e.classList.remove("hidden"),requestAnimationFrame(()=>{e.classList.add("animate-slide-in-down")})):(e.classList.add("hidden"),e.classList.remove("animate-slide-in-down"))}initSearchModule(){if(typeof window.Fuse=="undefined"){setTimeout(()=>this.initSearchModule(),500);return}s()}initSmoothScroll(){document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",t=>{let n=e.getAttribute("href");if(n==="#")return;let s=document.querySelector(n);s&&(t.preventDefault(),s.scrollIntoView({behavior:"smooth",block:"start"}),history.pushState(null,null,n))})})}initLazyLoading(){if("IntersectionObserver"in window){let e=new IntersectionObserver((e,t)=>{e.forEach(e=>{if(e.isIntersecting){let n=e.target;n.src=n.dataset.src||n.src,n.classList.add("fade-in"),t.unobserve(n)}})});document.querySelectorAll('img[loading="lazy"]').forEach(t=>{e.observe(t)})}}initServiceWorker(){"serviceWorker"in navigator&&location.protocol==="https:"&&navigator.serviceWorker.register("/sw.js").then(e=>{console.log("✅ Service Worker enregistr\xE9:",e.scope)}).catch(e=>{console.error("❌ Erreur Service Worker:",e)})}initScrollToTop(){let e=document.getElementById("scrollToTop");if(!e)return;e.addEventListener("click",()=>{window.scrollTo({top:0,behavior:"smooth"})});let t=()=>{window.pageYOffset>300?(e.style.opacity="1",e.style.visibility="visible"):(e.style.opacity="0",e.style.visibility="hidden")};e.style.opacity="0",e.style.visibility="hidden",e.style.transition="opacity 0.3s ease, visibility 0.3s ease",window.addEventListener("scroll",t)}initFilterReset(){let e=document.getElementById("filter-reset");e&&e.addEventListener("click",()=>{let e=document.getElementById("filter-category"),t=document.getElementById("filter-tag"),n=document.getElementById("filter-time"),s=document.querySelector(".search-input");e&&(e.selectedIndex=0),t&&(t.selectedIndex=0),n&&(n.value=""),s&&(s.value=""),typeof window.filterRecipes=="function"&&window.filterRecipes(),document.dispatchEvent(new CustomEvent("filtersReset"))})}handleError(e){console.error("Erreur application:",e),e.critical&&this.showNotification("Une erreur est survenue. Veuillez rafra\xEEchir la page.","error")}showNotification(e,t="info"){let n=document.createElement("div");n.className=`notification notification-${t}`,n.textContent=e,Object.assign(n.style,{position:"fixed",top:"20px",right:"20px",padding:"12px 20px",borderRadius:"6px",backgroundColor:t==="error"?"#ef4444":"#10b981",color:"white",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)",zIndex:"9999",transform:"translateX(400px)",transition:"transform 0.3s ease"}),document.body.appendChild(n),requestAnimationFrame(()=>{n.style.transform="translateX(0)"}),setTimeout(()=>{n.style.transform="translateX(400px)",setTimeout(()=>n.remove(),300)},3e3)}},t=new d;document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>t.init()):t.init(),u=t})()