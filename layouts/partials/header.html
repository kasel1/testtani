<!-- layouts/partials/header.html - VERSION MIGRÉE VERS NOUVEAU CSS -->

{{ $config := .Site.Data.config }}
{{ $site := $config.site }}
{{ $branding := $config.branding }}
{{ $social := $config.social }}
{{ $header := $config.header }}

<!-- ===== Header avec Z-INDEX UNIFIÉ ===== -->
<header class="relative" style="z-index: var(--z-fixed);">
  <!-- Effet de fond subtil -->
  <div class="absolute inset-0 bg-gradient-to-r from-transparent via-amber-500/5 to-transparent"></div>
  
  <!-- Particules minimalistes -->
  <div class="absolute inset-0 overflow-hidden pointer-events-none">
    <div class="absolute top-4 left-32 w-1 h-1 bg-amber-400/30 rounded-full animate-pulse"></div>
    <div class="absolute top-8 right-40 w-1 h-1 bg-amber-400/20 rounded-full animate-pulse animation-delay-1000"></div>
  </div>

  <!-- ===== Barre du haut : logo, recherche, réseaux sociaux ===== -->
  <div class="relative backdrop-blur-xl bg-white/80 border-b border-slate-200/50 shadow-sm" style="z-index: var(--z-fixed);">
    <div class="max-w-7xl mx-auto px-6 flex justify-between items-center h-16">
      
      <!-- Logo sophistiqué -->
      <a href="{{ .Site.BaseURL }}" class="group flex items-center space-x-3 no-underline" aria-label="Accueil">
        <div class="w-10 h-10 bg-gradient-to-br from-amber-400 to-amber-600 rounded-full flex items-center justify-center transform group-hover:scale-105 transition-all duration-300 shadow-lg">
          <span class="text-white font-bold text-lg">{{ $branding.logo_text | default (substr ($site.name | default .Site.Title) 0 1) }}</span>
        </div>
        <div class="hidden sm:block">
          <div class="text-2xl font-bold text-slate-900 group-hover:text-amber-700 transition-colors duration-300">
            {{ $site.name | default .Site.Title }}
          </div>
          <p class="text-xs text-slate-500 tracking-wider uppercase">{{ $site.tagline }}</p>
        </div>
      </a>

      <!-- Barre de recherche avec NOUVELLES CLASSES -->
      <div class="hidden md:block flex-1 max-w-lg mx-8">
        <div class="relative group">
          <div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
            <svg class="h-5 w-5 text-slate-400 group-focus-within:text-amber-500 transition-colors duration-200" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
            </svg>
          </div>
          {{ partial "search-input.html" (dict "Placeholder" $header.search_placeholder "TargetID" "input" "Class" "w-full pl-12 pr-4 py-3 bg-white/60 border border-slate-200/50 rounded-full text-slate-700 placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-amber-400/50 focus:border-amber-400 transition-all duration-300 backdrop-blur-sm") }}
        </div>
      </div>

      <!-- Réseaux sociaux élégants -->
      <div class="flex items-center space-x-4">
        <div class="hidden sm:flex items-center space-x-3">
          {{ with $social.facebook }}
          <a href="{{ . }}" aria-label="Facebook" class="w-10 h-10 bg-white/60 hover:bg-amber-50 rounded-full flex items-center justify-center text-slate-600 hover:text-amber-600 transition-all duration-300 backdrop-blur-sm border border-slate-200/50 hover:border-amber-200 hover:scale-105 transform">
            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
              <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
            </svg>
          </a>
          {{ end }}
          
          {{ with $social.instagram }}
          <a href="{{ . }}" aria-label="Instagram" class="w-10 h-10 bg-white/60 hover:bg-amber-50 rounded-full flex items-center justify-center text-slate-600 hover:text-amber-600 transition-all duration-300 backdrop-blur-sm border border-slate-200/50 hover:border-amber-200 hover:scale-105 transform">
            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
              <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/>
            </svg>
          </a>
          {{ end }}
        </div>
        
        <!-- Badge Pinterest sophistiqué -->
        {{ with $social.pinterest }}
        <a href="{{ . }}" target="_blank" rel="noopener" class="group relative inline-flex items-center px-4 py-2 bg-gradient-to-r from-amber-400 to-amber-500 rounded-full text-white text-sm font-medium tracking-wide hover:shadow-lg hover:shadow-amber-500/25 transform hover:scale-105 transition-all duration-300 animate-bounce">
          <span class="relative z-10">{{ $header.follow_button_text }}</span>
          <div class="absolute inset-0 bg-gradient-to-r from-amber-500 to-amber-600 rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
        </a>
        {{ end }}
      </div>
    </div>
  </div>

  <!-- ===== Navigation principale avec Z-INDEX UNIFIÉ ===== -->
  <nav class="relative backdrop-blur-xl bg-white/70 border-b border-slate-200/30" style="z-index: var(--z-sticky);" aria-label="Menu principal">
    <div class="max-w-7xl mx-auto px-6">
      <div class="hidden md:flex justify-center items-center h-16 space-x-12">
        {{ range .Site.Menus.main }}
          {{ $displayName := .Name }}
          {{ if eq .Identifier "home" }}{{ $displayName = $config.navigation.menu_items.home }}{{ end }}
          {{ if eq .Identifier "recipes" }}{{ $displayName = $config.navigation.menu_items.recipes }}{{ end }}
          {{ if eq .Identifier "categories" }}{{ $displayName = $config.navigation.menu_items.categories }}{{ end }}
          {{ if eq .Identifier "about" }}{{ $displayName = $config.navigation.menu_items.about }}{{ end }}
          {{ if eq .Identifier "contact" }}{{ $displayName = $config.navigation.menu_items.contact }}{{ end }}
          
          <a href="{{ .URL }}" class="relative {{ if or ($.Page.IsMenuCurrent "main" .) ($.Page.HasMenuCurrent "main" .) }}text-slate-900 after:w-full{{ else }}text-slate-700{{ end }} hover:text-amber-700 font-medium text-lg tracking-wide transition-all duration-300 no-underline after:content-[''] after:absolute after:bottom-[-8px] after:left-1/2 after:h-0.5 after:bg-gradient-to-r after:from-amber-400 after:to-amber-600 after:transition-all after:duration-300 after:transform after:-translate-x-1/2 {{ if not (or ($.Page.IsMenuCurrent "main" .) ($.Page.HasMenuCurrent "main" .)) }}after:w-0 hover:after:w-full{{ end }}" aria-current="{{ if or ($.Page.IsMenuCurrent "main" .) ($.Page.HasMenuCurrent "main" .) }}page{{ else }}false{{ end }}">
            {{ $displayName }}
          </a>
        {{ end }}
      </div>

      <!-- Menu mobile avec BOUTONS MIGRÉS -->
      <div class="flex items-center justify-between md:hidden h-16">
        <button id="mobile-menu-toggle" type="button" class="btn btn--ghost" aria-controls="mobile-menu" aria-expanded="false" aria-label="{{ $header.menu_aria_label }}">
          <svg id="menu-icon" class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
          </svg>
          <svg id="close-icon" class="h-6 w-6 is-hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
          </svg>
        </button>
        
        <!-- Recherche mobile avec BOUTON MIGRÉ -->
        <button id="mobile-search-toggle" class="btn btn--ghost md:hidden" aria-label="{{ $header.search_aria_label }}">
          <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
          </svg>
        </button>
      </div>
    </div>

    <!-- Menu mobile déroulant avec Z-INDEX UNIFIÉ -->
    <div class="hidden md:hidden bg-white/90 backdrop-blur-sm border-t border-slate-200/50 transform transition-all duration-300 ease-in-out" style="z-index: var(--z-overlay);" id="mobile-menu">
      <div class="px-6 py-4 space-y-3">
        {{ range .Site.Menus.main }}
          {{ $displayName := .Name }}
          {{ if eq .Identifier "home" }}{{ $displayName = $config.navigation.menu_items.home }}{{ end }}
          {{ if eq .Identifier "recipes" }}{{ $displayName = $config.navigation.menu_items.recipes }}{{ end }}
          {{ if eq .Identifier "categories" }}{{ $displayName = $config.navigation.menu_items.categories }}{{ end }}
          {{ if eq .Identifier "about" }}{{ $displayName = $config.navigation.menu_items.about }}{{ end }}
          {{ if eq .Identifier "contact" }}{{ $displayName = $config.navigation.menu_items.contact }}{{ end }}
          
          <a href="{{ .URL }}" class="block px-4 py-3 rounded-xl {{ if or ($.Page.IsMenuCurrent "main" .) ($.Page.HasMenuCurrent "main" .) }}text-slate-900 bg-amber-50{{ else }}text-slate-700 hover:text-amber-700 hover:bg-amber-50/50{{ end }} font-medium transition-all duration-200 no-underline" aria-current="{{ if or ($.Page.IsMenuCurrent "main" .) ($.Page.HasMenuCurrent "main" .) }}page{{ else }}false{{ end }}">
            {{ $displayName }}
          </a>
        {{ end }}
      </div>
    </div>

    <!-- Barre de recherche mobile avec Z-INDEX UNIFIÉ -->
    <div class="hidden md:hidden bg-white/95 backdrop-blur-sm border-t border-slate-200/50 transform transition-all duration-300 ease-in-out" style="z-index: var(--z-overlay);" id="mobile-search">
      <div class="px-6 py-4">
        <div class="relative">
          <div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
            <svg class="h-5 w-5 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
            </svg>
          </div>
          {{ partial "search-input.html" (dict "Placeholder" $header.search_placeholder_mobile "TargetID" "mobile-input" "Class" "w-full pl-12 pr-4 py-3 bg-white border border-slate-200 rounded-xl text-slate-700 placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-amber-400/50 focus:border-amber-400 transition-all duration-300") }}
        </div>
      </div>
    </div>
  </nav>
</header>
